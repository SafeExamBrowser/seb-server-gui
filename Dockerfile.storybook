# Build Storybook
FROM node:20.19.0 AS storybook-builder
WORKDIR /app/client

COPY client/package*.json ./
RUN npm install

COPY client/ .
RUN npm run build-storybook

# Final image - serve Storybook statically
FROM node:20.19.0-alpine
WORKDIR /app

RUN npm install -g serve

RUN mkdir -p public/storybook
COPY --from=storybook-builder /app/client/storybook-static/ ./public/storybook

EXPOSE 6006

CMD ["serve", "public", "-l", "6006", "--no-clipboard"]
