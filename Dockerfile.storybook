FROM ghcr.io/storydocker/storydocker:main

ARG WORKSPACE_DIR=application

# Localhost port for Storybook
ARG STORYBOOK_PORT=6006

# Internal-to-docker variable for Storybook port
ENV SB_PORT=$STORYBOOK_PORT

ENV NPM_CONFIG_LOGLEVEL warn

RUN npm i && npm cache clean --force

COPY . ./workspaces/${WORKSPACE_DIR}/

EXPOSE $STORYBOOK_PORT

# run storybook app
CMD ["npm", "run", "storybook", "-workspace", "workspaces/${WORKSPACE_DIR}/"]